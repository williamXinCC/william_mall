<view class="my-coupon"><view class="tabr" style="{{'top:'+(headerTop)+';'}}"><view data-event-opts="{{[['tap',[['switchType',['valid',1]]]]]}}" class="{{[(typeClass=='valid')?'on':'']}}" bindtap="__e">可用<block wx:if="{{state===1}}"><text>{{"("+couponList.length+")"}}</text></block></view><view data-event-opts="{{[['tap',[['switchType',['used',2]]]]]}}" class="{{[(typeClass=='used')?'on':'']}}" bindtap="__e">已使用<block wx:if="{{state===2}}"><text>{{"("+couponList.length+")"}}</text></block></view><view data-event-opts="{{[['tap',[['switchType',['invalid',3]]]]]}}" class="{{[(typeClass=='invalid')?'on':'']}}" bindtap="__e">已失效<block wx:if="{{state===3}}"><text>{{"("+couponList.length+")"}}</text></block></view><view class="{{['border',typeClass]}}"></view></view><view class="place"></view><view class="coupon-list"><block wx:if="{{state===3&&couponList.length>0}}"><view data-event-opts="{{[['tap',[['emptyInvalidCoupon',['$event']]]]]}}" class="empty-invalid" catchtap="__e"><view class="icon shanchu"></view>清空失效优惠券</view></block><view class="sub-list valid" style="{{'margin-top:'+(state===3?'50upx':0)+';'}}"><block wx:for="{{$root.l0}}" wx:for-item="row" wx:for-index="index" wx:key="index"><view class="row"><view class="carrier"><view class="left"><view class="in1line title"><text class="cell-icon">{{row.m0===2?'限':'全'}}</text>{{''+row.$orig.title+''}}</view><block wx:if="{{state!==2}}"><view class="term">{{''+row.f0+" ~ "+row.f1+''}}</view></block><block wx:else><view class="term">{{'使用时间：'+row.f2+''}}</view></block><block wx:if="{{state===3}}"><view class="overdue"><view class="iconfont iconyiguoqi2  _i"></view></view></block><block wx:if="{{state===2}}"><view class="overdue"><view class="iconfont iconyishiyong _i"></view></view></block><view class="usage">{{''+(row.m1===0?'不限':'每人限领'+row.$orig.couponType.max_fetch)+"\n              已领"+row.$orig.couponType.get_count+''}}<block wx:if="{{row.$orig.couponType.percentage}}"><text>{{"剩余"+row.$orig.couponType.percentage+"%"}}</text></block></view></view><view class="{{['right',(state!==1)?'invalid':'']}}"><view class="ticket"><view class="num">{{''+(row.$orig.money?'￥'+row.$orig.money:row.$orig.discount+'折')+''}}</view></view><view class="criteria">{{'满'+row.$orig.at_least+'使用'}}</view><block wx:if="{{row.m2===2}}"><view data-event-opts="{{[['tap',[['show',['$0'],[[['couponList','',index]]]]]]]}}" class="use view" bindtap="__e">商品</view></block><block wx:if="{{state==1}}"><view data-event-opts="{{[['tap',[['navTo',['/pages/category/category','tab']]]]]}}" class="use" bindtap="__e">去使用</view></block><block wx:else><view data-event-opts="{{[['tap',[['navTo',['/pages/order/detail?id='+row.$orig.use_order_id]]]]]}}" class="use" bindtap="__e">去查看</view></block></view></view></view></block></view><block wx:if="{{couponList.length>0}}"><rf-load-more vue-id="6e511fe2-1" status="{{loadingType}}" bind:__l="__l"></rf-load-more></block></view><block wx:if="{{couponList.length===0&&!loading}}"><rf-empty vue-id="6e511fe2-2" info="暂无优惠券" bind:__l="__l"></rf-empty></block><uni-drawer class="rf-drawer" vue-id="6e511fe2-3" visible="{{showRight}}" mode="right" data-event-opts="{{[['^close',[['closeDrawer']]]]}}" bind:close="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="rf-drawer-title">可用商品列表</view><view class="rf-drawer-list"><block wx:for="{{$root.l1}}" wx:for-item="item" wx:for-index="__i0__" wx:key="id"><view data-event-opts="{{[['tap',[['navTo',['/pages/product/product?id='+item.$orig.id]]]]]}}" class="rf-drawer-item" bindtap="__e"><view class="left"><view class="title">{{item.g0}}</view><view class="desc in2line">{{item.g1[1]}}</view></view><text class="iconfont iconyou"></text></view></block></view><view class="close"><button class="btn" plain="true" size="small" type="primary" data-event-opts="{{[['tap',[['hide',['$event']]]]]}}" bindtap="__e">关闭</button></view></uni-drawer><block wx:if="{{loading}}"><rf-loading vue-id="6e511fe2-4" bind:__l="__l"></rf-loading></block></view>